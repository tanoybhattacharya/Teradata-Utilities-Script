DEFINE JOB Export_to_File
DESCRIPTION 'Export Customer Data to File'
(	
	DEFINE SCHEMA Customer_Schema
	(
		cust_id CHAR(25),
		income CHAR(25),
		age   CHAR(2),
		years_with_bank CHAR(2),
		nbr_children CHAR(2),
		gender char(2),
		marital_status char(2)
	);

	DEFINE OPERATOR FILE_WRITER
	TYPE DATACONNECTOR CONSUMER
	SCHEMA Customer_Schema
	ATTRIBUTES
	(
		VARCHAR FILENAME='EXPORTOUTPUT.TXT',
		VARCHAR FORMAT = 'TEXT',
		VARCHAR OPERMODE = 'WRITE',
		VARCHAR INDICATORMODE = 'N'
	);

	DEFINE OPERATOR EXPORT_CUSTOMER
	TYPE EXPORT
	SCHEMA Customer_Schema
	ATTRIBUTES
	(
		VARCHAR USERNAME = 'dbc',
		VARCHAR USERPASSWORD = 'dbc',
		VARCHAR TdpId = '127.0.0.1',
		INTEGER  MAXSESSIONS = 2,
		VARCHAR SELECTSTMT = 'SELECT    CAST(CUST_ID AS CHAR(25)),
						CAST(INCOME AS CHAR(25)),
						CAST(AGE AS CHAR(2)),
						CAST(YEARS_WITH_BANK AS CHAR(2)),
						CAST(NBR_CHILDREN AS CHAR(2)),
						CAST(GENDER AS CHAR(2)),
						CAST(MARITAL_STATUS AS CHAR(2)) FROM FINANCIAL.CUSTOMER;'
	);

	APPLY TO OPERATOR(FILE_WRITER[1])
	SELECT CUST_ID,INCOME,AGE,YEARS_WITH_BANK,NBR_CHILDREN,GENDER,MARITAL_STATUS 
	FROM OPERATOR(EXPORT_CUSTOMER[1]);
);
	